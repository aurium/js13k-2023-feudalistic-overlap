@use "sass:math";
$rules: 0 pop, 1 kin, 2 bis, 3 nob, 4 pri, 5 kni, 6 bou, 7 ser, 8 pea;

:root {
  font-family: serif;
  font-size: min(1vw, 1vh);
}

body {
  margin: 0;
  padding: 0;
  background: #654;
  color: #FFF;
  overflow: hidden;
}

#board {
  position: absolute;
  top: 6em;
  bottom: 0;
  left: 0;
  right: 0;
}

h1 {
  font-family: my_fontregular;
  font-weight: normal;
  font-size: 3em;
  text-shadow: -.1em -.1em .2em rgba(255,255,255,.5);
  color: #654;
}

#src path {
  fill: url(#t1);
}

.coin {
  position: absolute;
  display: inline-block;
  width: var(--size);
  height: var(--size);
  margin: 0 0 0 -2em;
  cursor: grab;
  left: 105vw;
  transform: rotate(180deg);
  transition: 1s ease-out;

  &.created {
    transform: rotate(0);
    @media (orientation: portrait) {
      @each $idx,$r in $rules {
        $i: 1 - math.pow( 1 - math.div($idx, 8), 1.1);
        //&.#{$r} { top: #{calc(5 + $i/3)}vh; left: #{calc(3 + 102.5 * $i/10)}vw }
        &.#{$r} { top: #{calc(5 + $idx/3)}vh; left: #{calc( 3 + 82 * $i )}vw }
      }
      &.mv-left-1, &.mv-left-2, &.mv-right-1, &.mv-right-2 {
        transition: .5s ease-out;
      }
      &.mv-left-1 { transform: translateX(-4vw) rotate(-15deg) }
      &.mv-right-1 { transform: translateX(8vw) rotate(30deg) }
      &.mv-right-2 { transform: translateX(4vw) rotate(15deg) }
    }
    @media (orientation: landscape) {

    }
  }

  &:hover {
    //z-index: 5;
  }

  &::after {
    content: "";
    pointer-events: none;
    display: block;
    position: absolute;
    width: 100%;
    height: 100%;
    left: 0;
    top: 0;
    z-index: 9;
    background: var(--bgBW);
    background-position: var(--bgX) var(--bgY);
    background-size: 80em 80em;
    border-radius: 50%;
    mix-blend-mode: plus-lighter;
    opacity: 0;
    transform: scale(1);
    transition: 2s ease-out;
  }
  &.created::after {
    animation: 3s linear coin-init;
  }
  &:hover::after {
    animation: 2s linear coin-placed;
  }
  @keyframes coin-init {
    0% {
      opacity: 0;
      transform: scale(8);
    }
    33% {
      opacity: 0;
      transform: scale(8);
    }
    66% {
      opacity: .8;
      transform: scale(1);
    }
    100% {
      opacity: 0;
      transform: scale(1);
    }
  }
  @keyframes coin-placed {
    0% {
      opacity: 0;
      transform: scale(1);
    }
    33% {
      opacity: .5;
      transform: scale(1);
    }
    66% {
      opacity: .8;
      transform: scale(4);
    }
    100% {
      opacity: 0;
      transform: scale(8);
    }
  }
}

.coin i {
  display: block;
  position: absolute;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
  background: var(--bg0);
  background-position: var(--bgX) var(--bgY);
  background-size: 80em 80em;
  border-radius: 50%;
  overflow: hidden;
}

.coin i::before {
  content: "";
  display: block;
  position: absolute;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
  background: inherit;
  background-image: var(--bg1);
  opacity: 0;
  transition: .8s linear;
}
.coin:hover i::before {
  opacity: 1;
  transition: .4s linear;
}

.coin i::after {
  content: "";
  display: block;
  position: absolute;
  width: 300%;
  height: 100%;
  left: -300%;
  top: 0;
  background: linear-gradient(45deg, #444 33%, #FFF 50%, #FFF, transparent 70%);
  opacity: .9;
  mix-blend-mode: overlay;
  transition: .8s ease-out;
}
.coin:hover i::after {
  left: -50%;
  transition: .4s ease-out;
  /* animation: 1.1s linear 2 alternate shine; */
}
/* @keyframes shine {
  from { left: -200% }
  to { left: 80% }
} */

.coin b {
  display: block;
  position: absolute;
  width: 100%;
  height: 100%;
  left: .3em;
  top: .8em;
  background: #320;
  border-radius: 50%;
  box-shadow: .3em .3em .5em .2em rgba(0,0,0,.9);
}

.coin.pop {
  --size: 26.6em;
  --bgX: 0%;
  --bgY: 0%;
}
.coin.kin {
  --size: 25.2em;
  --bgX: 50%;
  --bgY: -.666em;
}
.coin.bis {
  --size: 23.8em;
  --bgX: -54.8em;
  --bgY: -1.333em;
}

.coin.nob {
  --size: 22.4em;
  --bgX: -2.1em;
  --bgY: 50%;
}
.coin.pri {
  --size: 21.0em;
  --bgX: 50%;
  --bgY: 50%;
}
.coin.kni {
  --size: 19.6em;
  --bgX: 23.2em;
  --bgY: 50%;
}

.coin.bou {
  --size: 18.2em;
  --bgX: -4.2em;
  --bgY: -57.5em;
}
.coin.ser {
  --size: 16.8em;
  --bgX: 50%;
  --bgY: -58.2em;
}
.coin.pea {
  --size: 15.4em;
  --bgX: -58.9em;
  --bgY: -58.9em;
}

#pieces-3, #pieces-4 {
  display: none;
}
